#!/usr/bin/python2

from gi.repository import Gdk
import sys
import os

DPI_FALLBACK = 96
HIDPI_LIMIT = (DPI_FALLBACK * 2)
CURSOR_SIZE = 24

def get_window_scale():
    window_scale = 1
    try:
        display = Gdk.Display.get_default()
        screen = display.get_default_screen()
        primary = screen.get_primary_monitor()

        rect = screen.get_monitor_geometry(primary)
        width_mm = screen.get_monitor_width_mm(primary)
        height_mm = screen.get_monitor_height_mm(primary)
        monitor_scale = screen.get_monitor_scale_factor(primary)

        if width_mm > 0 and height_mm > 0:
            dpi_x = rect.width * monitor_scale / (width_mm / 25.4)
            dpi_y = rect.height * monitor_scale / (height_mm / 25.4)
            if dpi_x > HIDPI_LIMIT and dpi_y > HIDPI_LIMIT:
                window_scale = 2
    except:
        pass # best-effort
    return window_scale

if __name__ == '__main__':
    print get_window_scale()
    sys.exit(0)
